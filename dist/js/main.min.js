/*! avgvst v0.0.3 | (c) 2020 Bulat | MIT License | https://github.com/BulatSa/avgvst */
/*! avgvst v0.0.3 | (c) 2020 Bulat | MIT License | https://github.com/BulatSa/avgvst */
function initFancy(){$(".fancy").fancybox({buttons:["close"]}),$(".fancy-modal").fancybox({selector:"",touch:!1}),$(".fancy-map").fancybox({toolbar:!1,smallBtn:!0,defaultType:"iframe"}),$(".fancy-video").fancybox({toolbar:!1,smallBtn:!0,youtube:{controls:1,showinfo:0,autoplay:1}})}$((function(){const e=$("input[type='tel']");if(e.length){String.prototype.replaceAt=function(e,t){return this.substr(0,e)+t+this.substr(e+t.length)};const t={onKeyPress:function(e,t,s,l){if("8"===e.charAt(1)){const e=s.get(0).value;s.get(0).value=e.replaceAt(1,"7")}}};e.mask("+0 (000) 000-00-00",t),e.on("focus",(function(e){c(e),$(this).get(0).value.length<2&&($(this).get(0).value="+")})),e.on("blur",(function(e){c(e),"+"===$(this).get(0).value&&($(this).get(0).value="")}))}const t=document.querySelectorAll(".ajax-form"),s=document.querySelectorAll("input[type=email]"),l=document.querySelectorAll("input.input-text"),c=e=>{const t=e.target.parentElement;"focus"===e.type&&""===e.target.value&&t.classList.add("active"),"blur"===e.type&&""===e.target.value&&(t.classList.remove("active"),t.classList.remove("error"))},o=e=>{const t=e.target.querySelectorAll("input[data-req]"),s=e.target.querySelector("input[type=email]"),l=s.parentElement;e.target.querySelectorAll(".input-label select").forEach((e=>{const t=e.parentElement;t.querySelector(".select2").classList.contains("selected")?t.classList.remove("error"):t.classList.add("error"),$(e).on("select2:select",(function(e){$(this).parent().removeClass("error")}))})),s.validity.valid||(e.preventDefault(),l.classList.add("error")),t.forEach((t=>{""===t.value?(e.preventDefault(),t.parentElement.classList.add("error")):t.parentElement.classList.remove("error")}))},r=e=>{const t=e.target.parentElement;e.target.validity.valid?t.classList.remove("error"):t.classList.add("error")},n=e=>{const t=e.target.parentElement;""===e.target.value?t.classList.add("error"):t.classList.remove("error")};l.forEach((e=>{e.addEventListener("focus",c),e.addEventListener("blur",c),e.addEventListener("input",n)})),s.forEach((e=>{e.addEventListener("input",r)})),t.forEach((e=>{e.addEventListener("submit",o)}))})),$((function(){const e=/^((?!chrome|android).)*Macintosh/i.test(navigator.userAgent),t=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);(e||t)&&$(".class").length&&$(".class").addClass("is-macos")})),$.fancybox.defaults.backFocus=!1,$.fancybox.defaults.autoFocus=!1,$.fancybox.defaults.lang="ru",$.fancybox.defaults.i18n={ru:{CLOSE:"Закрыть",NEXT:"Дальше",PREV:"Назад",ERROR:"Не удается загрузить. <br/> Попробуйте позднее.",PLAY_START:"Начать слайдшоу",PLAY_STOP:"Остановить слайдшоу",FULL_SCREEN:"На весь экран",THUMBS:"Превью"}},$((function(){initFancy()})),$((function(){$(".scrollto").length&&$(".scrollto").on("click",(function(){const e=$(this).attr("href"),t=$(e).offset().top;return $("html,body").stop().animate({scrollTop:t},1e3),!1}))})),$((function(){$(".anim").length&&$(".anim").waypoint((function(){$(this.element).toggleClass("animated")}),{offset:"85%"})})),$((function(){const e=document.querySelector("[data-menu-open]"),t=document.querySelector("[data-mobile-menu-open]"),s=document.querySelector("."+e.dataset.menuOpen),l=document.querySelector("."+t.dataset.mobileMenuOpen),c=document.querySelectorAll("[data-search-open]"),o=document.querySelector("[data-search-open]"),r=document.querySelector("[data-search-close]"),n=document.querySelector("."+o.dataset.searchOpen),a=document.querySelector(".search-form input"),i=document.querySelector(".search-form span"),d=document.querySelector(".header-search__result-wrap"),u=document.querySelector(".header-search__result-list"),m=document.body,f="scroll-up",p="scroll-down",v="fixed-menu",L="init-fixed-menu",h=document.querySelector(".header-page-wrap"),y=document.querySelector(".header-page-sticky").offsetTop,g=h.offsetHeight;let S=0;(()=>{const e=h.clientHeight;document.documentElement.style.setProperty("--header-page-height",e+"px")})(),initScrollWidth=()=>{let e=document.createElement("div");e.style.overflowY="scroll",e.style.width="50px",e.style.height="50px",document.body.append(e);let t=e.offsetWidth-e.clientWidth;e.remove(),document.documentElement.style.setProperty("--body-scroll-width",t+"px")};const E=()=>{const e=window.pageYOffset;if(e<=y)return m.classList.remove(f),m.classList.remove(p),m.classList.remove(v),void m.classList.remove(L);e>g&&e>S&&!m.classList.contains(f)&&(m.classList.remove(f),m.classList.add(p)),e>5*g&&e>S&&(m.classList.remove(f),m.classList.add(p),m.classList.add(v)),e<S-5&&m.classList.contains(p)&&(m.classList.remove(p),m.classList.remove(L),m.classList.add(f)),S=e},q=()=>{m.classList.contains("scroll-lock")?m.classList.remove("scroll-lock"):m.classList.add("scroll-lock")};window.addEventListener("scroll",E);const $=e=>{null===e.target.closest(".header-page-menu")&&null===e.target.closest("[data-menu-open]")&&k()},b=()=>{document.removeEventListener("click",$)},_=()=>{window.removeEventListener("scroll",E)},k=t=>{s.classList.contains("open")&&(e.classList.remove("open"),s.classList.remove("open"),b(),q(),window.addEventListener("scroll",E))};if(o){const e=e=>{e.preventDefault(),q(),n.classList.contains("open")?(n.classList.remove("open"),window.addEventListener("scroll",E),m()):(n.classList.add("open"),_())},t=()=>{""!==a.value?(d.classList.remove("empty"),d.classList.add("finded"),a.classList.add("active")):(d.classList.remove("finded"),d.classList.add("empty"),a.classList.remove("active"))},s=()=>{d.classList.remove("empty"),d.classList.remove("finded")},l=()=>{u.innerHTML=""},o=()=>{a.value="",a.classList.remove("active")},m=()=>{s(),l(),o()};c.forEach((t=>{t.addEventListener("click",e)})),r.addEventListener("click",e),a.addEventListener("input",t),i.addEventListener("click",m)}if(e){const t=t=>{t.preventDefault(),q(),s.classList.contains("open")?(e.classList.remove("open"),s.classList.remove("open"),b(),window.addEventListener("scroll",E)):(e.classList.add("open"),s.classList.add("open"),document.addEventListener("click",$),_())};e.addEventListener("click",t)}if(t){const e=e=>{e.preventDefault(),q(),l.classList.contains("open")?(t.classList.remove("open"),l.classList.remove("open"),window.addEventListener("scroll",E)):(t.classList.add("open"),l.classList.add("open"),_())};t.addEventListener("click",e)}})),$((function(){const e=document.querySelectorAll(".header-mobile-menu .sub-link"),t=e=>{e.preventDefault();const t=e.target.parentElement,s=e.target,l=t.querySelector("ul");l.style.height=l.scrollHeight+"px",s.classList.toggle("open"),l.style.height=s.classList.contains("open")?l.scrollHeight+"px":0};e.forEach((e=>{e.addEventListener("click",t)}))})),$(document).ready((function(){const e=e=>{if(!e.id)return e.text;const t=e.element,s=t.dataset.flagsrc,l=t.dataset.title,c=t.dataset.descr;return $(`\n      <img src="${s}"/>\n      <span class="title">${l}</span>\n      <span class="descr">${c}</span>\n    `)},t=e=>{if(!e.id)return e.text;const t=e.element.dataset.title;return $(`\n      <span class="title">${t}</span>\n    `)};$(".select2-js--currency").select2({theme:"avgvst-currency",dropdownAutoWidth:!0,minimumResultsForSearch:1/0,templateResult:e,templateSelection:e}),$(".select2-js--default").select2({width:"100%",scrollAfterSelect:!0,theme:"avgvst-default",minimumResultsForSearch:1/0,templateResult:t,templateSelection:t}),$(".select2-js--filter").select2({width:"100%",scrollAfterSelect:!0,theme:"avgvst-filter",minimumResultsForSearch:1/0,templateResult:t,templateSelection:e=>{if(!e.id)return e.text;return $('\n      <span class="title">сортировка</span>\n    ')}}),$(".select2-js--card").select2({width:"100%",scrollAfterSelect:!0,theme:"avgvst-card",minimumResultsForSearch:1/0,templateResult:t,templateSelection:t}),$(".select2-js--horoscope").select2({width:"100%",scrollAfterSelect:!0,theme:"avgvst-default",minimumResultsForSearch:1/0,templateResult:t,templateSelection:t}),$(document).on("onComplete.fb",(function(e,t,s){s.$slide.find("select").select2({dropdownParent:s.$content})})),$(".select2-js--horoscope").on("select2:select",(function(e){$(this).next(".select2").addClass("selected")}))})),$((function(){const e=document.querySelectorAll("[data-checkbox-list-link]"),t=e=>{null===e.target.closest(".catalog-filter__item.opened")&&l()},s=()=>{document.removeEventListener("click",t)},l=()=>{document.querySelectorAll("[data-checkbox-list-link]").forEach((e=>{const t=e.dataset.checkboxListLink,s=e.parentElement,l=e.parentElement.querySelector("."+t);s.classList.remove("opened"),e.classList.remove("opened"),l.classList.remove("opened")})),s()},c=e=>{const c=e.currentTarget,o=c.dataset.checkboxListLink,r=c.parentElement,n=c.parentElement.querySelector("."+o);c.classList.contains("opened")?(c.classList.remove("opened"),r.classList.remove("opened"),n.classList.remove("opened"),s()):(l(),c.classList.add("opened"),r.classList.add("opened"),n.classList.add("opened"),document.addEventListener("click",t))};e.forEach((e=>{e.addEventListener("click",c)}));const o=document.querySelectorAll(".catalog-filter__checkbox-list .style-checkbox"),r=e=>{const t=document.querySelector(".catalog-filter"),s=e.currentTarget.closest(".catalog-filter__item").querySelector(".catalog-filter__item-title .counter"),l=e.currentTarget.closest(".catalog-filter__item"),c=e.currentTarget.parentElement.querySelectorAll("input[type=checkbox]");let o=0;c.forEach((e=>{e.checked&&o++}),0),s.textContent=o,o>0?(l.classList.add("filtered"),t.classList.add("filtered")):(l.classList.remove("filtered"),t.classList.remove("filtered"))},n=e=>{const t=document.querySelector(".catalog-filter"),s=e.currentTarget.closest(".catalog-filter__item"),l=e.currentTarget.parentElement.querySelectorAll("input[type=checkbox]"),c=e.currentTarget.closest(".catalog-filter__item").querySelector(".choice");let o=0,r="";l.forEach((e=>{const t=e.dataset.mobileDescr;e.checked&&(o++,""===r?r+=t:r=r+", "+t)})),o>0?(t.classList.add("filtered"),s.classList.add("filtered")):(s.classList.remove("filtered"),t.querySelectorAll(".catalog-filter__item.filtered").length||t.classList.remove("filtered"),c.textContent=""),c.textContent=r,(()=>{const e=document.querySelectorAll(".catalog-filter__item.filtered").length;document.querySelector("[data-mobile-filter-opener]").querySelector(".catalog-filter__item-title span").textContent=e})()};document.documentElement.clientWidth>960&&o.forEach((e=>{e.addEventListener("change",r)})),document.documentElement.clientWidth<960&&o.forEach((e=>{e.addEventListener("change",n)}));const a=e=>{const t=document.querySelector(".catalog-filter"),s=e.currentTarget.closest(".catalog-filter__item");e.currentTarget.querySelector("input[type=checkbox]").checked?(t.classList.add("filtered"),s.classList.add("filtered")):(s.classList.remove("filtered"),(()=>{if(document.querySelectorAll(".catalog-filter__item.filtered").length)return!0})()||t.classList.remove("filtered"))};document.querySelectorAll(".catalog-filter__item > .style-checkbox").forEach((e=>{e.addEventListener("change",a)}));const i=document.querySelector(".catalog-filter__form"),d=()=>{$(".catalog-filter__form .select2-js").val("").trigger("change"),(()=>{const e=document.querySelector(".catalog-filter"),t=e.querySelectorAll(".catalog-filter__item"),s=e.querySelectorAll(".choice");t.forEach((t=>{t.querySelector(".catalog-filter__checkbox-list")&&(t.querySelector(".catalog-filter__item-title .counter").textContent=0,t.classList.remove("filtered"),e.classList.remove("filtered"))})),s.forEach((e=>{e.textContent=""}))})()};i&&i.addEventListener("reset",d)})),$((function(){const e=document.querySelectorAll("[data-fixed-modal]"),t=e=>{e.preventDefault();const t=document.querySelector("body"),s=e.currentTarget.dataset.src,l=document.querySelector(""+s);t.classList.add("scroll-lock"),l.classList.add("opened")},s=e=>{e.preventDefault();const t=document.querySelector("body");document.querySelectorAll(".modal-mobile").forEach((e=>{e.classList.remove("opened")})),t.classList.remove("scroll-lock")};document.querySelectorAll(".modal-close").forEach((e=>{e.addEventListener("click",s)})),e.forEach((e=>{e.addEventListener("click",t)}))}));